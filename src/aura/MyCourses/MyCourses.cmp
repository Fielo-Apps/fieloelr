<aura:component controller="CoursesController" access="global" >
    
    <aura:attribute name="configDefault" type="String" access="global" default='{"fieldset":[{"apiName":"Name","type":"subcomponent","subcomponent":"FieloELR:ShowRecord","label":{"type":"default"},"showLabel":true},{"apiName":"FieloELR__Progress__c","type":"subcomponent","subcomponent":"FieloELR:ProgressBar","config":{"layout":"bar"},"label":{"type":"text","value":"Progress"},"showLabel":true}],"quantity":5,"Course":{"fieldset":[{"apiName":"Name","type":"output","label":{"type":"default"},"showLabel":true},{"apiName":"FieloELR__Description__c","type":"output","label":{"type":"default"},"showLabel":true},{"apiName":"FieloELR__ApprovalGrade__c","type":"output","label":{"type":"default"},"showLabel":true},{"apiName":"Name","type":"subcomponent","subcomponent":"FieloELR:ModuleCheck","label":{"type":"label","value":"c.SuccessfullyCompleted"},"showLabel":true},{"apiName":"TakeModule","type":"subcomponent","subcomponent":"FieloELR:TakeModule","label":{"type":"text","value":""},"showLabel":false}],"moduleResponse":[{"apiName":"FieloELR__NumberOfAttempt__c","label":{"type":"default"},"type":"output","showLabel":true}]}}'/>
    
    <!-- DESIGN ATTRIBUTES -->    
    <aura:attribute type="String" name="titleValue" access="global"/>
    <aura:attribute type="String" name="layout" access="global" />
    <aura:attribute type="Integer" name="columns" access="global" />    
    <aura:attribute type="String" name="courseDetailFields" access="global" />
    <aura:attribute type="String" name="courseLayout" access="global" />    
    <aura:attribute name="courseColumns" type="String" access="global" />
    <aura:attribute name="fields" type="String" access="global" />
    <aura:attribute name="showCourseProgress" type="Boolean" access="global" />
    <!-- DESIGN ATTRIBUTES -->


    <aura:attribute type="FieloPLT__Member__c" name="member" />
    <aura:attribute type="Boolean" name="showMyCourses" default="false"/>
    <aura:attribute type="String" name="title" />
    
    <aura:attribute type="sObject[]" name="fieldset" default="[]" />
    <aura:attribute type="sObject[]" name="myCourses" default="[]" />
    
    <aura:attribute type="FieloELR__Module__c[]" name="modules" />
    <aura:attribute type="sObject[]" name="courseFieldset" />
    <aura:attribute type="Boolean" name="showCourse" default="false" />
    
    <aura:attribute type="String" name="courseTitle" default="" />        
    
    <!-- PAGINADOR -->
    <aura:attribute name="paging" type="Boolean" />
    <aura:attribute name="quantity" type="Integer"/>    
    <aura:handler name="paging" event="c:PaginatorEvent" action="{!c.paginator}" default="false"/>        
    <!-- PAGINADOR -->
    
    <aura:handler name="showRecord" event="c:ShowRecordEvent" action="{!c.showCourse}"/>
    
    <aura:handler event="c:ShowModuleResponseEvent" action="{!c.showModuleResponse}"/>
    <aura:attribute type="Boolean" name="showModuleResponse" default="false" />
    <aura:attribute type="sObject" name="moduleResponse" />
    
    <!-- MODULE RESPONSE -->
    <aura:attribute type="sObject[]" name="moduleResponseFieldset" />
    <aura:attribute type="String" name="moduleResponseFields" default="FieloELR__NumberOfAttempt__c" access="global" />
    <!-- MODULE RESPONSE -->

    <aura:handler event="FieloPLT:UpdateMemberEvent" action="{!c.updateMember}"/>
    <aura:handler name="init" action="{!c.doInit}" value="{!this}"/>        
    
    <aura:attribute type="String" name="config" access="global"/>
        

    
    <aura:if isTrue="{!v.showMyCourses}">       
        <h3 class="slds-section-title--divider">{!v.title}</h3>
        <c:ListView objectAPIName="FieloELR__Course__c" layout="{!v.layout}" columns="{!v.columns}" fieldset="{!v.fieldset}" records="{!v.myCourses}" paging="false" quantity="{!v.quantity}" />
    </aura:if>
    
        <aura:if isTrue="{!v.showCourse}">        
        <div>
            <h3 class="slds-section-title--divider slds-float_left">{!v.courseTitle}</h3>        
            <lightning:button class="slds-float_right" variant="neutral" label="Back to Courses" onclick="{!c.showCoursesList }" />
        </div>
        
        <c:ListView objectAPIName="FieloELR__Module__c" layout="{!v.courseLayout}" columns="{!v.courseColumns}" fieldset="{!v.courseFieldset}" records="{!v.modules}" />
    </aura:if>
    <aura:if isTrue="{!v.showModuleResponse}">
            <div class="slds-clearfix slds-p-bottom--small">
                <h3 class="slds-section-title--divider slds-float_left">{!v.moduleTitle}</h3>        
                    <lightning:button class="slds-float_right" variant="neutral" label="Back to Course" onclick="{!c.showCourseInformation }" />            
            </div>                
            <c:ModuleResponse moduleResponse="{!v.moduleResponse}" fieldset="{!v.moduleResponseFieldset}" fieldsModuleResponse="{!v.moduleResponseFields}"/>       
        </aura:if>
    
    <c:Spinner />   
</aura:component>